<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Loading...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <base href="/">
    <script>
      // Fetch the app shell and inject it so Angular can bootstrap on deep links
      fetch('/index.html', { credentials: 'same-origin' })
        .then(function(res){ return res.text(); })
        .then(function(html){
          // Extract body content from index.html
          var bodyContent = html.split('<body>')[1].split('</body>')[0];
          document.body.innerHTML = bodyContent;
          // Re-execute scripts by recreating them
          var div = document.createElement('div');
          div.innerHTML = html;
          var scripts = div.getElementsByTagName('script');
          for (var i = 0; i < scripts.length; i++) {
            var s = document.createElement('script');
            if (scripts[i].src) s.src = scripts[i].src;
            if (scripts[i].type) s.type = scripts[i].type;
            s.defer = scripts[i].defer || false;
            s.async = scripts[i].async || false;
            document.body.appendChild(s);
          }
        })
        .catch(function(){ document.body.innerHTML = '<h1>Not Found</h1>'; });
    </script>
    <style>body{margin:0;background:#111;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}</style>
  </head>
  <body>
    Loading...
  </body>
</html>
