<div class="availability-container">
  <h2>Available Room Types</h2>
  
  <!-- Selected Dates Display -->
  <div *ngIf="selectedDates" class="selected-dates">
    <div class="date-info">
      <span class="date-label">Check-in:</span>
      <span class="date-value">{{ formatDate(selectedDates.checkIn) }}</span>
    </div>
    <div class="date-info">
      <span class="date-label">Check-out:</span>
      <span class="date-value">{{ formatDate(selectedDates.checkOut) }}</span>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading available rooms...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <p class="error-message">{{ error }}</p>
    <button (click)="loadAvailableRoomTypes()" class="retry-btn">Try Again</button>
  </div>

  <!-- Room Types List -->
  <div *ngIf="!loading && !error && availableRoomTypes.length" class="room-type-list">
    <div *ngFor="let type of availableRoomTypes; index as i" 
         class="room-card">
      <div class="room-card-index">
        {{ (i + 1) | number: '2.0' }}
      </div>

      <div class="room-card-content">
        <div class="room-media">
          <div class="room-images-grid">
            <img [src]="getRoomImage(type.type, 1)" [alt]="type.type + ' - View 1'" (click)="openImageModal(type.type, 0)" style="cursor: pointer;">
            <img [src]="getRoomImage(type.type, 2)" [alt]="type.type + ' - View 2'" (click)="openImageModal(type.type, 1)" style="cursor: pointer;">
            <img [src]="getRoomImage(type.type, 3)" [alt]="type.type + ' - View 3'" (click)="openImageModal(type.type, 2)" style="cursor: pointer;">
            <img [src]="getRoomImage(type.type, 4)" [alt]="type.type + ' - View 4'" (click)="openImageModal(type.type, 3)" style="cursor: pointer;">
          </div>
        </div>

        <div class="room-info">
          <h3>{{ type.type }}</h3>

          <div class="availability-count low-availability" 
              *ngIf="isLowAvailability(type.type)">
            <span class="warning-text">
              ⚠ Only a few rooms left! ({{ getAvailabilityCount(type.type).available }} available)
            </span>
          </div>

          <!-- Room Details Inline -->
          <div class="room-details-dropdown">
            <div class="details-content">
              <h4>Room Description</h4>
              <p class="room-description">{{ getRoomDescription(type.type) }}</p>
              
              <div class="availability-details">
                <h4>Availability for Selected Dates</h4>
                <div class="availability-stats">
                  <div class="stat-item">
                    <span class="stat-label">Total Rooms:</span>
                    <span class="stat-value">{{ getAvailabilityCount(type.type).total }}</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Available:</span>
                    <span class="stat-value available">{{ getAvailabilityCount(type.type).available }}</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Occupied:</span>
                    <span class="stat-value occupied">{{ getAvailabilityCount(type.type).total - getAvailabilityCount(type.type).available }}</span>
                  </div>
                </div>
              </div>

              <div class="amenities-section">
                <h4>Room Amenities</h4>
                <ul class="amenities-list">
                  <li *ngFor="let amenity of getRoomAmenities(type.type)">{{ amenity }}</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="price-and-action">
            <div class="price-circle">
              ₱{{ type.rate || type.basePrice }}
            </div>

            <div class="reservation-fee-info" *ngIf="type.reservationFeePercentage">
              <span class="fee-label">Reservation Fee:</span>
              <span class="fee-percentage">{{ type.reservationFeePercentage }}%</span>
            </div>

            <button type="button"
                  class="select-indicator"
                  [class.unavailable]="getAvailabilityCount(type.type).available === 0"
                  [disabled]="getAvailabilityCount(type.type).available === 0"
                  (click)="selectRoomType(type)">
              {{ getAvailabilityCount(type.type).available > 0 ? 'SELECT ROOM' : 'UNAVAILABLE' }}
            </button>
          </div>
        </div>
      </div>
      
    </div>
  </div>
  
  <!-- No Rooms Available -->
  <div *ngIf="!loading && !error && availableRoomTypes.length === 0" class="no-rooms">
    <p>No room types available for the selected dates.</p>
    <button (click)="loadAvailableRoomTypes()" class="refresh-btn">Refresh</button>
  </div>
  
  <button type="button" (click)="back.emit()" class="btn-secondary back-button">Back</button>
</div>
<div *ngIf="isModalOpen" class="image-modal-overlay" (click)="closeImageModal()">
        <div class="image-modal-content" (click)="$event.stopPropagation()">
          <button class="modal-close-btn" (click)="closeImageModal()">&times;</button>
          
          <button class="modal-nav-btn prev" (click)="prevImage()">&#10094;</button>
          
          <img [src]="selectedImages[currentImageIndex]" alt="Room View {{ currentImageIndex + 1 }}" class="modal-image">
          
          <button class="modal-nav-btn next" (click)="nextImage()">&#10095;</button>

          <div class="modal-counter">
              
          </div>  
        </div>
      </div>